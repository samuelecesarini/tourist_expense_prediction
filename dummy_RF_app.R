# Import libraries
library(shiny)
library(data.table)
library(randomForest)

# Read in the RF model
model <- readRDS("model.rds")


####################################
# User interface                   #
####################################

ui <- pageWithSidebar(
  
  # Page header
  headerPanel('Average tourist expenditure prediction'),
  # Input values
  sidebarPanel(
    #HTML("<h3>Input parameters</h3>"),
    tags$label(h3('Input parameters')),
    numericInput("durata_viaggio_numero_notti",
                 label = "durata_viaggio_numero_notti",
                 value = 0),
    numericInput("sessoFemmine",
                 label = "sessoFemmine",
                 value = 0),
    numericInput("sessoMaschi",
                 label = "sessoMaschi",
                 value = 0),
    numericInput("classi_eta.minore_14.anni",
                 label = "classi_eta.minore_14.anni",
                 value = 0),
    numericInput("classi_eta.maggiore_75.anni",
                 label = "classi_eta.maggiore_75.anni",
                 value = 0),
    numericInput("classi_eta15.24.anni",
                 label = "classi_eta15.24.anni",
                 value = 0),
    numericInput("classi_eta25.34.anni",
                 label = "classi_eta25.34.anni",
                 value = 0),
    numericInput("classi_eta35.44.anni",
                 label = "classi_eta35.44.anni",
                 value = 0),
    numericInput("classi_eta45.54.anni",
                 label = "classi_eta45.54.anni",
                 value = 0),
    numericInput("classi_eta55.64.anni",
                 label = "classi_eta55.64.anni",
                 value = 0),
    numericInput("classi_eta65.74.anni",
                 label = "classi_eta65.74.anni",
                 value = 0),
    numericInput("stato_civileCelibeNubile",
                 label = "stato_civileCelibeNubile",
                 value = 0),
    numericInput("stato_civileConiugato",
                 label = "stato_civileConiugato",
                 value = 0),
    numericInput("stato_civileSeparato.Divorziato",
                 label = "stato_civileSeparato.Divorziato",
                 value = 0),
    numericInput("stato_civileVedovo",
                 label = "stato_civileVedovo",
                 value = 0),
    numericInput("paese_nascitaEstero",
                 label = "paese_nascitaEstero",
                 value = 0),
    numericInput("paese_nascitaItalia",
                 label = "paese_nascitaItalia",
                 value = 0),
    numericInput("regione_residenzaAbruzzo",
                 label = "regione_residenzaAbruzzo",
                 value = 0),
    numericInput("regione_residenzaBasilicata",
                 label = "regione_residenzaBasilicata",
                 value = 0),
    numericInput("regione_residenzaCalabria",
                 label = "regione_residenzaCalabria",
                 value = 0),
    numericInput("regione_residenzaCampania",
                 label = "regione_residenzaCampania",
                 value = 0),
    numericInput("regione_residenzaEmilia.Romagna",
                 label = "regione_residenzaEmilia.Romagna",
                 value = 0),
    numericInput("regione_residenzaFriuli.Venezia.Giulia",
                 label = "regione_residenzaFriuli.Venezia.Giulia",
                 value = 0),
    numericInput("regione_residenzaLazio",
                 label = "regione_residenzaLazio",
                 value = 0),
    numericInput("regione_residenzaLiguria",
                 label = "regione_residenzaLiguria",
                 value = 0),
    numericInput("regione_residenzaLombardia",
                 label = "regione_residenzaLombardia",
                 value = 0),
    numericInput("regione_residenzaMarche",
                 label = "regione_residenzaMarche",
                 value = 0),
    numericInput("regione_residenzaMolise",
                 label = "regione_residenzaMolise",
                 value = 0),
    numericInput("regione_residenzaPiemonte",
                 label = "regione_residenzaPiemonte",
                 value = 0),
    numericInput("regione_residenzaPuglia",
                 label = "regione_residenzaPuglia",
                 value = 0),
    numericInput("regione_residenzaSardegna",
                 label = "regione_residenzaSardegna",
                 value = 0),
    numericInput("regione_residenzaSicilia",
                 label = "regione_residenzaSicilia",
                 value = 0),
    numericInput("regione_residenzaToscana",
                 label = "regione_residenzaToscana",
                 value = 0),
    numericInput("regione_residenzaTrentino.A.Adige.Sudtirol",
                 label = "regione_residenzaTrentino.A.Adige.Sudtirol",
                 value = 0),
    numericInput("regione_residenzaUmbria",
                 label = "regione_residenzaUmbria",
                 value = 0),
    numericInput("regione_residenzaValle.d.Aosta.Valle.e.d.Aoste",
                 label = "regione_residenzaValle.d.Aosta.Valle.e.d.Aoste",
                 value = 0),
    numericInput("regione_residenzaVeneto",
                 label = "regione_residenzaVeneto",
                 value = 0),
    numericInput("titolo_studio_piu_alto_conseguitoDiploma.di.scuola.secondaria.superiore.o.qualifica.professionale",
                 label = "titolo_studio_piu_alto_conseguitoDiploma.di.scuola.secondaria.superiore.o.qualifica.professionale",
                 value = 0),
    numericInput("titolo_studio_piu_alto_conseguitoDiploma.universitario..ex.scuole.parauniversitarie..laurea..post.laurea",
                 label = "titolo_studio_piu_alto_conseguitoDiploma.universitario..ex.scuole.parauniversitarie..laurea..post.laurea",
                 value = 0),
    numericInput("titolo_studio_piu_alto_conseguitoLicenza.di.scuola.media..o.avviamento.professionale.",
                 label = "titolo_studio_piu_alto_conseguitoLicenza.di.scuola.media..o.avviamento.professionale.",
                 value = 0),
    numericInput("titolo_studio_piu_alto_conseguitoNessun.titolo.Licenza.elementare",
                 label = "titolo_studio_piu_alto_conseguitoNessun.titolo.Licenza.elementare",
                 value = 0),
    numericInput("condizione_professionale_oggettiva.eta.non.lavorativa",
                 label = "condizione_professionale_oggettiva.eta.non.lavorativa",
                 value = 0),
    numericInput("condizione_professionale_oggettivaIn.cerca.di.occupazione",
                 label = "condizione_professionale_oggettivaIn.cerca.di.occupazione",
                 value = 0),
    numericInput("condizione_professionale_oggettivaInattivo",
                 label = "condizione_professionale_oggettivaInattivo",
                 value = 0),
    numericInput("condizione_professionale_oggettivaOccupato",
                 label = "condizione_professionale_oggettivaOccupato",
                 value = 0),
    numericInput("regione_destinazioneAbruzzo",
                 label = "regione_destinazioneAbruzzo",
                 value = 0),
    numericInput("regione_destinazioneBasilicata",
                 label = "regione_destinazioneBasilicata",
                 value = 0),
    numericInput("regione_destinazioneCalabria",
                 label = "regione_destinazioneCalabria",
                 value = 0),
    numericInput("regione_destinazioneCampania",
                 label = "regione_destinazioneCampania",
                 value = 0),
    numericInput("regione_destinazioneEmilia.Romagna",
                 label = "regione_destinazioneEmilia.Romagna",
                 value = 0),
    numericInput("regione_destinazioneFriuli.Venezia.Giulia",
                 label = "regione_destinazioneFriuli.Venezia.Giulia",
                 value = 0),
    numericInput("regione_destinazioneLazio",
                 label = "regione_destinazioneLazio",
                 value = 0),
    numericInput("regione_destinazioneLiguria",
                 label = "regione_destinazioneLiguria",
                 value = 0),
    numericInput("regione_destinazioneLombardia",
                 label = "regione_destinazioneLombardia",
                 value = 0),
    numericInput("regione_destinazioneMarche",
                 label = "regione_destinazioneMarche",
                 value = 0),
    numericInput("regione_destinazioneMolise",
                 label = "regione_destinazioneMolise",
                 value = 0),
    numericInput("regione_destinazionePiemonte",
                 label = "regione_destinazionePiemonte",
                 value = 0),
    numericInput("regione_destinazionePuglia",
                 label = "regione_destinazionePuglia",
                 value = 0),
    numericInput("regione_destinazioneSardegna",
                 label = "regione_destinazioneSardegna",
                 value = 0),
    numericInput("regione_destinazioneSicilia",
                 label = "regione_destinazioneSicilia",
                 value = 0),
    numericInput("regione_destinazioneToscana",
                 label = "regione_destinazioneToscana",
                 value = 0),
    numericInput("regione_destinazioneTrentino.Alto.Adige.Sudtirol",
                 label = "regione_destinazioneTrentino.Alto.Adige.Sudtirol",
                 value = 0),
    numericInput("regione_destinazioneUmbria",
                 label = "regione_destinazioneUmbria",
                 value = 0),
    numericInput("regione_destinazioneValle.d.Aosta.Vallee..d.Aoste",
                 label = "regione_destinazioneValle.d.Aosta.Vallee..d.Aoste",
                 value = 0),
    numericInput("regione_destinazioneVeneto",
                 label = "regione_destinazioneVeneto",
                 value = 0),
    numericInput("mese_inizio_viaggioAgosto",
                 label = "mese_inizio_viaggioAgosto",
                 value = 0),
    numericInput("mese_inizio_viaggioAprile",
                 label = "mese_inizio_viaggioAprile",
                 value = 0),
    numericInput("mese_inizio_viaggioDicembre",
                 label = "mese_inizio_viaggioDicembre",
                 value = 0),
    numericInput("mese_inizio_viaggioFebbraio",
                 label = "mese_inizio_viaggioFebbraio",
                 value = 0),
    numericInput("mese_inizio_viaggioGennaio",
                 label = "mese_inizio_viaggioGennaio",
                 value = 0),
    numericInput("mese_inizio_viaggioGiugno",
                 label = "mese_inizio_viaggioGiugno",
                 value = 0),
    numericInput("mese_inizio_viaggioLuglio",
                 label = "mese_inizio_viaggioLuglio",
                 value = 0),
    numericInput("mese_inizio_viaggioMaggio",
                 label = "mese_inizio_viaggioMaggio",
                 value = 0),
    numericInput("mese_inizio_viaggioMarzo",
                 label = "mese_inizio_viaggioMarzo",
                 value = 0),
    numericInput("mese_inizio_viaggioNovembre",
                 label = "mese_inizio_viaggioNovembre",
                 value = 0),
    numericInput("mese_inizio_viaggioOttobre",
                 label = "mese_inizio_viaggioOttobre",
                 value = 0),
    numericInput("mese_inizio_viaggioSettembre",
                 label = "mese_inizio_viaggioSettembre",
                 value = 0),
    numericInput("motivo_prevalente_vacanzaMotivo.religiosio.pellegrinaggio",
                 label = "motivo_prevalente_vacanzaMotivo.religiosio.pellegrinaggio",
                 value = 0),
    numericInput("motivo_prevalente_vacanzaPiacere..svago..vacanza",
                 label = "motivo_prevalente_vacanzaPiacere..svago..vacanza",
                 value = 0),
    numericInput("motivo_prevalente_vacanzaTrattamento.di.salute..cura.termale",
                 label = "motivo_prevalente_vacanzaTrattamento.di.salute..cura.termale",
                 value = 0),
    numericInput("motivo_prevalente_vacanzaVisita.a.parenti.e.o.amici",
                 label = "motivo_prevalente_vacanzaVisita.a.parenti.e.o.amici",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoAereo",
                 label = "principale_mezzo_trasporto_utilizzatoAereo",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoAltro",
                 label = "principale_mezzo_trasporto_utilizzatoAltro",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoAuto.a.noleggio",
                 label = "principale_mezzo_trasporto_utilizzatoAuto.a.noleggio",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoAuto.propria..di.parenti.amici",
                 label = "principale_mezzo_trasporto_utilizzatoAuto.propria..di.parenti.amici",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoCamper..autocaravan",
                 label = "principale_mezzo_trasporto_utilizzatoCamper..autocaravan",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoMoto..Motoscooter",
                 label = "principale_mezzo_trasporto_utilizzatoMoto..Motoscooter",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoNave..battello..motoscafo",
                 label = "principale_mezzo_trasporto_utilizzatoNave..battello..motoscafo",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoPullman.di.linea",
                 label = "principale_mezzo_trasporto_utilizzatoPullman.di.linea",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoPullman.turistico",
                 label = "principale_mezzo_trasporto_utilizzatoPullman.turistico",
                 value = 0),
    numericInput("principale_mezzo_trasporto_utilizzatoTreno",
                 label = "principale_mezzo_trasporto_utilizzatoTreno",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoAbitazione.di.parenti.o.amici.gratuita",
                 label = "principale_alloggio_utilizzatoAbitazione.di.parenti.o.amici.gratuita",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoAbitazione.in.affitto",
                 label = "principale_alloggio_utilizzatoAbitazione.in.affitto",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoAbitazione.in.proprieta.o.multiprop.",
                 label = "principale_alloggio_utilizzatoAbitazione.in.proprieta.o.multiprop.",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoAgriturismo",
                 label = "principale_alloggio_utilizzatoAgriturismo",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoAlbergo.motel.pensione",
                 label = "principale_alloggio_utilizzatoAlbergo.motel.pensione",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoAltra.struttura.collettiva",
                 label = "principale_alloggio_utilizzatoAltra.struttura.collettiva",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoAltro.tipo.di.sistemazione.privata",
                 label = "principale_alloggio_utilizzatoAltro.tipo.di.sistemazione.privata",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoBarca.in.sito.non.organizzato",
                 label = "principale_alloggio_utilizzatoBarca.in.sito.non.organizzato",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoBed.breakfast",
                 label = "principale_alloggio_utilizzatoBed.breakfast",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoCampeggio",
                 label = "principale_alloggio_utilizzatoCampeggio",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoCampo.lavoro.e.vacanza",
                 label = "principale_alloggio_utilizzatoCampo.lavoro.e.vacanza",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoIstituto.religioso",
                 label = "principale_alloggio_utilizzatoIstituto.religioso",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoMezzo.pubblico.di.trasporto",
                 label = "principale_alloggio_utilizzatoMezzo.pubblico.di.trasporto",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoResidenza.per.cure.fisiche.ed.estetiche",
                 label = "principale_alloggio_utilizzatoResidenza.per.cure.fisiche.ed.estetiche",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoStanza.in.affitto",
                 label = "principale_alloggio_utilizzatoStanza.in.affitto",
                 value = 0),
    numericInput("principale_alloggio_utilizzatoVillaggio.vacanza",
                 label = "principale_alloggio_utilizzatoVillaggio.vacanza",
                 value = 0),
    numericInput("organizzazione_alloggioNessuna.prenotazione",
                 label = "organizzazione_alloggioNessuna.prenotazione",
                 value = 0),
    numericInput("organizzazione_alloggioNon.sa.non.risponde",
                 label = "organizzazione_alloggioNon.sa.non.risponde",
                 value = 0),
    numericInput("organizzazione_alloggioPrenot..diretta",
                 label = "organizzazione_alloggioPrenot..diretta",
                 value = 0),
    numericInput("organizzazione_alloggioPrenot..in.agenzia.tour.operator",
                 label = "organizzazione_alloggioPrenot..in.agenzia.tour.operator",
                 value = 0),
    numericInput("organizzazione_trasportoNessuna.prenotazione",
                 label = "organizzazione_trasportoNessuna.prenotazione",
                 value = 0),
    numericInput("organizzazione_trasportoNon.sa.non.risponde",
                 label = "organizzazione_trasportoNon.sa.non.risponde",
                 value = 0),
    numericInput("organizzazione_trasportoPrenot..diretta",
                 label = "organizzazione_trasportoPrenot..diretta",
                 value = 0),
    numericInput("organizzazione_trasportoPrenot..in.agenzia.tour.operator",
                 label = "organizzazione_trasportoPrenot..in.agenzia.tour.operator",
                 value = 0),
    numericInput("numero_componenti_famiglia1",
                 label = "numero_componenti_famiglia1",
                 value = 0),
    numericInput("numero_componenti_famiglia2",
                 label = "numero_componenti_famiglia2",
                 value = 0),
    numericInput("numero_componenti_famiglia3",
                 label = "numero_componenti_famiglia3",
                 value = 0),
    numericInput("numero_componenti_famiglia4",
                 label = "numero_componenti_famiglia4",
                 value = 0),
    numericInput("numero_componenti_famiglia5.e.piu..partecipanti",
                 label = "numero_componenti_famiglia5.e.piu..partecipanti",
                 value = 0),
    numericInput("tipo_attivita_principaleAltro.motivo.volontariato.shopping.hobby.eventi.sportivi.visita.a.parchi.divertimento.zoo.acquario.etc",
                 label = "tipo_attivita_principaleAltro.motivo.volontariato.shopping.hobby.eventi.sportivi.visita.a.parchi.divertimento.zoo.acquario.etc",
                 value = 0),
    numericInput("tipo_attivita_principaleBellezze.naturali",
                 label = "tipo_attivita_principaleBellezze.naturali",
                 value = 0),
    numericInput("tipo_attivita_principaleCultura",
                 label = "tipo_attivita_principaleCultura",
                 value = 0),
    numericInput("tipo_attivita_principaleDivertimento..riposo.o.relax",
                 label = "tipo_attivita_principaleDivertimento..riposo.o.relax",
                 value = 0),
    numericInput("tipo_attivita_principaleGastronomia..folklore.spettacoli",
                 label = "tipo_attivita_principaleGastronomia..folklore.spettacoli",
                 value = 0),
    numericInput("tipo_attivita_principalenon.specificata",
                 label = "tipo_attivita_principalenon.specificata",
                 value = 0),
    numericInput("tipo_attivita_principalePratica.di.sport..settimana.bianca..trekking..escursionismo..caccia.o.pesca..scuola.di.vela..rafting..equitazione...ballo",
                 label = "tipo_attivita_principalePratica.di.sport..settimana.bianca..trekking..escursionismo..caccia.o.pesca..scuola.di.vela..rafting..equitazione...ballo",
                 value = 0),
    numericInput("tipo_attivita_principaleStudio.formazione",
                 label = "tipo_attivita_principaleStudio.formazione",
                 value = 0),
    numericInput("tipo_attivita_principaleTrattamenti.di.salute.benessere.beauty.farm.spa",
                 label = "tipo_attivita_principaleTrattamenti.di.salute.benessere.beauty.farm.spa",
                 value = 0),
    
    actionButton("submitbutton", "Submit", 
                 class = "btn btn-primary")
  ),
  
  mainPanel(
    tags$label(h3('Status/Output')), # Status/Output Text Box
    verbatimTextOutput('contents'),
    tableOutput('tabledata') # Prediction results table
    
  )
)

####################################
# Server                           #
####################################

server<- function(input, output, session) {
  
  
  # Input Data
  datasetInput <- reactive({  
    
    df <- data.frame(
      durata_viaggio_numero_notti=input$durata_viaggio_numero_notti,
      sessoFemmine=input$sessoFemmine,
      sessoMaschi=input$sessoMaschi,
      classi_eta.minore_14.anni=input$classi_eta.minore_14.anni,
      classi_eta.maggiore_75.anni=input$classi_eta.maggiore_75.anni,
      classi_eta15.24.anni=input$classi_eta15.24.anni,
      classi_eta25.34.anni=input$classi_eta25.34.anni,
      classi_eta35.44.anni=input$classi_eta35.44.anni,
      classi_eta45.54.anni=input$classi_eta45.54.anni,
      classi_eta55.64.anni=input$classi_eta55.64.anni,
      classi_eta65.74.anni=input$classi_eta65.74.anni,
      stato_civileCelibeNubile=input$stato_civileCelibeNubile,
      stato_civileConiugato=input$stato_civileConiugato,
      stato_civileSeparato.Divorziato=input$stato_civileSeparato.Divorziato,
      stato_civileVedovo=input$stato_civileVedovo,
      paese_nascitaEstero=input$paese_nascitaEstero,
      paese_nascitaItalia=input$paese_nascitaItalia,
      regione_residenzaAbruzzo=input$regione_residenzaAbruzzo,
      regione_residenzaBasilicata=input$regione_residenzaBasilicata,
      regione_residenzaCalabria=input$regione_residenzaCalabria,
      regione_residenzaCampania=input$regione_residenzaCampania,
      regione_residenzaEmilia.Romagna=input$regione_residenzaEmilia.Romagna,
      regione_residenzaFriuli.Venezia.Giulia=input$regione_residenzaFriuli.Venezia.Giulia,
      regione_residenzaLazio=input$regione_residenzaLazio,
      regione_residenzaLiguria=input$regione_residenzaLiguria,
      regione_residenzaLombardia=input$regione_residenzaLombardia,
      regione_residenzaMarche=input$regione_residenzaMarche,
      regione_residenzaMolise=input$regione_residenzaMolise,
      regione_residenzaPiemonte=input$regione_residenzaPiemonte,
      regione_residenzaPuglia=input$regione_residenzaPuglia,
      regione_residenzaSardegna=input$regione_residenzaSardegna,
      regione_residenzaSicilia=input$regione_residenzaSicilia,
      regione_residenzaToscana=input$regione_residenzaToscana,
      regione_residenzaTrentino.A.Adige.Sudtirol=input$regione_residenzaTrentino.A.Adige.Sudtirol,
      regione_residenzaUmbria=input$regione_residenzaUmbria,
      regione_residenzaValle.d.Aosta.Valle.e.d.Aoste=input$regione_residenzaValle.d.Aosta.Valle.e.d.Aoste,
      regione_residenzaVeneto=input$regione_residenzaVeneto,
      titolo_studio_piu_alto_conseguitoDiploma.di.scuola.secondaria.superiore.o.qualifica.professionale=input$titolo_studio_piu_alto_conseguitoDiploma.di.scuola.secondaria.superiore.o.qualifica.professionale,
      titolo_studio_piu_alto_conseguitoDiploma.universitario..ex.scuole.parauniversitarie..laurea..post.laurea=input$titolo_studio_piu_alto_conseguitoDiploma.universitario..ex.scuole.parauniversitarie..laurea..post.laurea,
      titolo_studio_piu_alto_conseguitoLicenza.di.scuola.media..o.avviamento.professionale.=input$titolo_studio_piu_alto_conseguitoLicenza.di.scuola.media..o.avviamento.professionale.,
      titolo_studio_piu_alto_conseguitoNessun.titolo.Licenza.elementare=input$titolo_studio_piu_alto_conseguitoNessun.titolo.Licenza.elementare,
      condizione_professionale_oggettiva.eta.non.lavorativa=input$condizione_professionale_oggettiva.eta.non.lavorativa,
      condizione_professionale_oggettivaIn.cerca.di.occupazione=input$condizione_professionale_oggettivaIn.cerca.di.occupazione,
      condizione_professionale_oggettivaInattivo=input$condizione_professionale_oggettivaInattivo,
      condizione_professionale_oggettivaOccupato=input$condizione_professionale_oggettivaOccupato,
      regione_destinazioneAbruzzo=input$regione_destinazioneAbruzzo,
      regione_destinazioneBasilicata=input$regione_destinazioneBasilicata,
      regione_destinazioneCalabria=input$regione_destinazioneCalabria,
      regione_destinazioneCampania=input$regione_destinazioneCampania,
      regione_destinazioneEmilia.Romagna=input$regione_destinazioneEmilia.Romagna,
      regione_destinazioneFriuli.Venezia.Giulia=input$regione_destinazioneFriuli.Venezia.Giulia,
      regione_destinazioneLazio=input$regione_destinazioneLazio,
      regione_destinazioneLiguria=input$regione_destinazioneLiguria,
      regione_destinazioneLombardia=input$regione_destinazioneLombardia,
      regione_destinazioneMarche=input$regione_destinazioneMarche,
      regione_destinazioneMolise=input$regione_destinazioneMolise,
      regione_destinazionePiemonte=input$regione_destinazionePiemonte,
      regione_destinazionePuglia=input$regione_destinazionePuglia,
      regione_destinazioneSardegna=input$regione_destinazioneSardegna,
      regione_destinazioneSicilia=input$regione_destinazioneSicilia,
      regione_destinazioneToscana=input$regione_destinazioneToscana,
      regione_destinazioneTrentino.Alto.Adige.Sudtirol=input$regione_destinazioneTrentino.Alto.Adige.Sudtirol,
      regione_destinazioneUmbria=input$regione_destinazioneUmbria,
      regione_destinazioneValle.d.Aosta.Vallee..d.Aoste=input$regione_destinazioneValle.d.Aosta.Vallee..d.Aoste,
      regione_destinazioneVeneto=input$regione_destinazioneVeneto,
      mese_inizio_viaggioAgosto=input$mese_inizio_viaggioAgosto,
      mese_inizio_viaggioAprile=input$mese_inizio_viaggioAprile,
      mese_inizio_viaggioDicembre=input$mese_inizio_viaggioDicembre,
      mese_inizio_viaggioFebbraio=input$mese_inizio_viaggioFebbraio,
      mese_inizio_viaggioGennaio=input$mese_inizio_viaggioGennaio,
      mese_inizio_viaggioGiugno=input$mese_inizio_viaggioGiugno,
      mese_inizio_viaggioLuglio=input$mese_inizio_viaggioLuglio,
      mese_inizio_viaggioMaggio=input$mese_inizio_viaggioMaggio,
      mese_inizio_viaggioMarzo=input$mese_inizio_viaggioMarzo,
      mese_inizio_viaggioNovembre=input$mese_inizio_viaggioNovembre,
      mese_inizio_viaggioOttobre=input$mese_inizio_viaggioOttobre,
      mese_inizio_viaggioSettembre=input$mese_inizio_viaggioSettembre,
      motivo_prevalente_vacanzaMotivo.religiosio.pellegrinaggio=input$motivo_prevalente_vacanzaMotivo.religiosio.pellegrinaggio,
      motivo_prevalente_vacanzaPiacere..svago..vacanza=input$motivo_prevalente_vacanzaPiacere..svago..vacanza,
      motivo_prevalente_vacanzaTrattamento.di.salute..cura.termale=input$motivo_prevalente_vacanzaTrattamento.di.salute..cura.termale,
      motivo_prevalente_vacanzaVisita.a.parenti.e.o.amici=input$motivo_prevalente_vacanzaVisita.a.parenti.e.o.amici,
      principale_mezzo_trasporto_utilizzatoAereo=input$principale_mezzo_trasporto_utilizzatoAereo,
      principale_mezzo_trasporto_utilizzatoAltro=input$principale_mezzo_trasporto_utilizzatoAltro,
      principale_mezzo_trasporto_utilizzatoAuto.a.noleggio=input$principale_mezzo_trasporto_utilizzatoAuto.a.noleggio,
      principale_mezzo_trasporto_utilizzatoAuto.propria..di.parenti.amici=input$principale_mezzo_trasporto_utilizzatoAuto.propria..di.parenti.amici,
      principale_mezzo_trasporto_utilizzatoCamper..autocaravan=input$principale_mezzo_trasporto_utilizzatoCamper..autocaravan,
      principale_mezzo_trasporto_utilizzatoMoto..Motoscooter=input$principale_mezzo_trasporto_utilizzatoMoto..Motoscooter,
      principale_mezzo_trasporto_utilizzatoNave..battello..motoscafo=input$principale_mezzo_trasporto_utilizzatoNave..battello..motoscafo,
      principale_mezzo_trasporto_utilizzatoPullman.di.linea=input$principale_mezzo_trasporto_utilizzatoPullman.di.linea,
      principale_mezzo_trasporto_utilizzatoPullman.turistico=input$principale_mezzo_trasporto_utilizzatoPullman.turistico,
      principale_mezzo_trasporto_utilizzatoTreno=input$principale_mezzo_trasporto_utilizzatoTreno,
      principale_alloggio_utilizzatoAbitazione.di.parenti.o.amici.gratuita=input$principale_alloggio_utilizzatoAbitazione.di.parenti.o.amici.gratuita,
      principale_alloggio_utilizzatoAbitazione.in.affitto=input$principale_alloggio_utilizzatoAbitazione.in.affitto,
      principale_alloggio_utilizzatoAbitazione.in.proprieta.o.multiprop.=input$principale_alloggio_utilizzatoAbitazione.in.proprieta.o.multiprop.,
      principale_alloggio_utilizzatoAgriturismo=input$principale_alloggio_utilizzatoAgriturismo,
      principale_alloggio_utilizzatoAlbergo.motel.pensione=input$principale_alloggio_utilizzatoAlbergo.motel.pensione,
      principale_alloggio_utilizzatoAltra.struttura.collettiva=input$principale_alloggio_utilizzatoAltra.struttura.collettiva,
      principale_alloggio_utilizzatoAltro.tipo.di.sistemazione.privata=input$principale_alloggio_utilizzatoAltro.tipo.di.sistemazione.privata,
      principale_alloggio_utilizzatoBarca.in.sito.non.organizzato=input$principale_alloggio_utilizzatoBarca.in.sito.non.organizzato,
      principale_alloggio_utilizzatoBed.breakfast=input$principale_alloggio_utilizzatoBed.breakfast,
      principale_alloggio_utilizzatoCampeggio=input$principale_alloggio_utilizzatoCampeggio,
      principale_alloggio_utilizzatoCampo.lavoro.e.vacanza=input$principale_alloggio_utilizzatoCampo.lavoro.e.vacanza,
      principale_alloggio_utilizzatoIstituto.religioso=input$principale_alloggio_utilizzatoIstituto.religioso,
      principale_alloggio_utilizzatoMezzo.pubblico.di.trasporto=input$principale_alloggio_utilizzatoMezzo.pubblico.di.trasporto,
      principale_alloggio_utilizzatoResidenza.per.cure.fisiche.ed.estetiche=input$principale_alloggio_utilizzatoResidenza.per.cure.fisiche.ed.estetiche,
      principale_alloggio_utilizzatoStanza.in.affitto=input$principale_alloggio_utilizzatoStanza.in.affitto,
      principale_alloggio_utilizzatoVillaggio.vacanza=input$principale_alloggio_utilizzatoVillaggio.vacanza,
      organizzazione_alloggioNessuna.prenotazione=input$organizzazione_alloggioNessuna.prenotazione,
      organizzazione_alloggioNon.sa.non.risponde=input$organizzazione_alloggioNon.sa.non.risponde,
      organizzazione_alloggioPrenot..diretta=input$organizzazione_alloggioPrenot..diretta,
      organizzazione_alloggioPrenot..in.agenzia.tour.operator=input$organizzazione_alloggioPrenot..in.agenzia.tour.operator,
      organizzazione_trasportoNessuna.prenotazione=input$organizzazione_trasportoNessuna.prenotazione,
      organizzazione_trasportoNon.sa.non.risponde=input$organizzazione_trasportoNon.sa.non.risponde,
      organizzazione_trasportoPrenot..diretta=input$organizzazione_trasportoPrenot..diretta,
      organizzazione_trasportoPrenot..in.agenzia.tour.operator=input$organizzazione_trasportoPrenot..in.agenzia.tour.operator,
      numero_componenti_famiglia1=input$numero_componenti_famiglia1,
      numero_componenti_famiglia2=input$numero_componenti_famiglia2,
      numero_componenti_famiglia3=input$numero_componenti_famiglia3,
      numero_componenti_famiglia4=input$numero_componenti_famiglia4,
      numero_componenti_famiglia5.e.piu..partecipanti=input$numero_componenti_famiglia5.e.piu..partecipanti,
      tipo_attivita_principaleAltro.motivo.volontariato.shopping.hobby.eventi.sportivi.visita.a.parchi.divertimento.zoo.acquario.etc=input$tipo_attivita_principaleAltro.motivo.volontariato.shopping.hobby.eventi.sportivi.visita.a.parchi.divertimento.zoo.acquario.etc,
      tipo_attivita_principaleBellezze.naturali=input$tipo_attivita_principaleBellezze.naturali,
      tipo_attivita_principaleCultura=input$tipo_attivita_principaleCultura,
      tipo_attivita_principaleDivertimento..riposo.o.relax=input$tipo_attivita_principaleDivertimento..riposo.o.relax,
      tipo_attivita_principaleGastronomia..folklore.spettacoli=input$tipo_attivita_principaleGastronomia..folklore.spettacoli,
      tipo_attivita_principalenon.specificata=input$tipo_attivita_principalenon.specificata,
      tipo_attivita_principalePratica.di.sport..settimana.bianca..trekking..escursionismo..caccia.o.pesca..scuola.di.vela..rafting..equitazione...ballo=input$tipo_attivita_principalePratica.di.sport..settimana.bianca..trekking..escursionismo..caccia.o.pesca..scuola.di.vela..rafting..equitazione...ballo,
      tipo_attivita_principaleStudio.formazione=input$tipo_attivita_principaleStudio.formazione,
      tipo_attivita_principaleTrattamenti.di.salute.benessere.beauty.farm.spa=input$tipo_attivita_principaleTrattamenti.di.salute.benessere.beauty.farm.spa)
    test <- read.csv(paste("input", ".csv", sep=""), header = TRUE)
    Output <- data.frame(Prediction=predict(model, test))
    print(Output)
    
  })
  
  
  # Status/Output Text Box
  output$contents <- renderPrint({
    if (input$submitbutton>0) { 
      isolate("Calculation complete.") 
    } else {
      return("Server is ready for calculation.")
    }
  })
  
  # Prediction results table
  output$tabledata <- renderTable({
    if (input$submitbutton>0) { 
      isolate(datasetInput()) 
    } 
  })
  
}

####################################
# Create the shiny app             #
####################################
shinyApp(ui = ui, server = server)
